# 医学宝典 - 环境变量配置示例
# 复制此文件为 .env.local 并填写实际配置

# ==================== 应用配置 ====================
NODE_ENV=development
PORT=3000

# CORS 跨域配置
# 开发环境: 可以使用逗号分隔的多个域名，例如: "http://localhost:5173,http://localhost:3000"
# 生产环境: 必须指定具体域名，不能使用 "*" 通配符
# 格式: "https://domain1.com,https://domain2.com"
CORS_ORIGIN=http://localhost:5173

# ==================== 数据库配置 ====================
DB_HOST=localhost
DB_PORT=3306
DB_USERNAME=root
DB_PASSWORD=your_password_here
DB_DATABASE=medical_bible

# ==================== Redis 配置 ====================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0

# ==================== JWT 配置 ====================
# Access Token 签名密钥（必须设置，至少32个随机字符）
JWT_SECRET=your_jwt_secret_here_please_change_it
# Access Token 过期时间（默认: 15m）
JWT_ACCESS_EXPIRES=15m
# Refresh Token 签名密钥（独立于 Access Token 密钥，提高安全性）
# 如果不设置，将使用 JWT_SECRET
JWT_REFRESH_SECRET=your_jwt_refresh_secret_here_different_from_access
# Refresh Token 过期时间（默认: 7d）
JWT_REFRESH_EXPIRES=7d

# ==================== 加密密钥 ====================
# 用于加密敏感配置（如支付密钥），请使用随机字符串
# 生产环境必须设置此值，否则使用不安全的默认密钥
ENCRYPTION_KEY=your_random_encryption_key_at_least_32_chars

# ==================== 限流配置 ====================
# 是否启用限流（默认: true）
RATE_LIMIT_ENABLED=true

# 全局限流配置（所有请求的总体限流）
RATE_LIMIT_GLOBAL_MAX=1000
RATE_LIMIT_GLOBAL_WINDOW=60

# 认证端点限流配置（登录、刷新令牌等）
RATE_LIMIT_AUTH_MAX=10
RATE_LIMIT_AUTH_WINDOW=3600

# 普通端点限流配置
RATE_LIMIT_STANDARD_MAX=30
RATE_LIMIT_STANDARD_WINDOW=60

# 验证码端点限流配置
RATE_LIMIT_VERIFICATION_MAX=10
RATE_LIMIT_VERIFICATION_WINDOW=86400

# 严格端点限流配置（注册、重置密码等）
RATE_LIMIT_STRICT_MAX=5
RATE_LIMIT_STRICT_WINDOW=60

# 宽松端点限流配置
RATE_LIMIT_RELAXED_MAX=100
RATE_LIMIT_RELAXED_WINDOW=60

# 限流键前缀
RATE_LIMIT_KEY_PREFIX=rate_limit

# Redis 不可用时是否跳过限流检查（生产环境建议设为 false）
RATE_LIMIT_SKIP_ON_REDIS_ERROR=false

# ==================== 阿里云 OSS 配置 ====================
OSS_ACCESS_KEY_ID=your_access_key_id
OSS_ACCESS_KEY_SECRET=your_access_key_secret
OSS_BUCKET=medical-bible
OSS_REGION=oss-cn-beijing
OSS_ENDPOINT=https://oss-cn-beijing.aliyuncs.com

# ==================== 安全头配置 ====================
# 安全头中间件开关（默认启用）
SECURITY_ENABLED=true

# HSTS (HTTP Strict Transport Security) - 强制 HTTPS
# 仅在生产环境启用（需要 HTTPS）
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUB_DOMAINS=true
HSTS_PRELOAD=false

# CSP (Content Security Policy) - 内容安全策略
# 防止 XSS 攻击，控制资源加载来源
CSP_ENABLED=true
CSP_DEFAULT_SRC='self'
CSP_SCRIPT_SRC='self'
CSP_STYLE_SRC='self','unsafe-inline'
CSP_IMG_SRC='self','data:','https:'
CSP_CONNECT_SRC='self'
CSP_FONT_SRC='self'
CSP_OBJECT_SRC='none'
CSP_MEDIA_SRC='self'
CSP_FRAME_SRC='none'
CSP_WORKER_SRC='self'
CSP_BASE_URI='self'
CSP_FORM_ACTION='self'
CSP_FRAME_ANCESTORS='none'
CSP_UPGRADE_INSECURE=true

# X-Frame-Options (已弃用，建议使用 CSP frame-ancestors)
X_FRAME_OPTIONS=DENY

# Referrer-Policy
REFERRER_POLICY=strict-origin-when-cross-origin

# 跨域策略（默认禁用，按需启用）
CROSS_ORIGIN_EMBEDDER_POLICY=false
CROSS_ORIGIN_RESOURCE_POLICY=false

# ==================== WebSocket 配置 ====================
# 每个用户最大同时连接数
WS_MAX_CONNECTIONS_PER_USER=3

# 连接心跳间隔（毫秒）
WS_HEARTBEAT_INTERVAL=25000

# 连接超时时间（毫秒）
WS_CONNECTION_TIMEOUT=60000

# 消息队列过期时间（秒），默认 7 天
WS_MESSAGE_QUEUE_TTL=604800

# 重连延迟初始值（毫秒）
WS_RECONNECT_DELAY_MIN=1000

# 重连延迟最大值（毫秒）
WS_RECONNECT_DELAY_MAX=30000

# 重连尝试次数限制
WS_MAX_RECONNECT_ATTEMPTS=10

# ==================== 以下配置已迁移到数据库管理 ====================
# 短信、邮件、支付等配置现在通过后台管理界面配置
# 存储在 system_configs 表中，敏感信息会自动加密
