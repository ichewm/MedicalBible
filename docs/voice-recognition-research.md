# 语音识别技术研究

## 概述

本文档对比了语音识别技术选项，为 Medical Bible 平台选择合适的语音识别方案。

## Web Speech API

### 浏览器支持
- **Chrome/Edge**: 完全支持 (webkitSpeechRecognition)
- **Safari**: 部分支持 (SpeechRecognition，需要 HTTPS)
- **Firefox**: 实验性支持 (需要手动启用)
- **Opera**: 支持

### 优点
- **免费**: 无需额外成本
- **无需后端改动**: 完全在前端实现
- **低延迟**: 本地处理，响应快速
- **隐私友好**: 语音数据不发送到第三方服务器
- **易于实现**: 标准化 API，代码简洁

### 缺点
- **语言支持有限**: 主要支持英语、中文（简体）、日语等
- **准确性一般**: 对于专业术语识别率可能不高
- **需要 HTTPS**: 生产环境必须使用 HTTPS
- **无持久化语音配置**: 不支持用户语音训练
- **浏览器兼容性**: 部分浏览器不支持或需要特殊配置

### 支持的语言
- 中文（简体）: zh-CN
- 中文（繁体）: zh-TW
- 英语: en-US
- 日语: ja-JP
- 韩语: ko-KR
- 以及其他 40+ 语言

## 云服务对比

### Azure Speech Service

**优点**:
- 高准确率，专业领域优化
- 支持 100+ 语言
- 支持自定义语音模型
- 支持语音训练和个性化
- 提供 SDK 和 REST API

**缺点**:
- 按使用量付费
- 需要网络连接
- 增加后端复杂度
- 数据隐私考虑（语音数据发送到微软）

**定价**: 免费层 5 小时/月，之后约 $1/小时

### Google Cloud Speech-to-Text

**优点**:
- 高准确率
- 支持 125+ 语言和方言
- 支持自动标点
- 支持视频字幕生成
- 强大的噪声处理能力

**缺点**:
- 按使用量付费
- 需要网络连接
- 国内访问可能需要特殊配置

**定价**: 免费层 60 分钟/月，之后约 $0.006/15秒

### 阿里云语音识别

**优点**:
- 中文识别优化
- 国内网络访问稳定
- 支持方言识别
- 价格相对较低

**缺点**:
- 主要针对中文市场
- 按使用量付费

**定价**: 按调用次数计费，约 0.0005元/次

### 讯飞语音

**优点**:
- 中文语音识别领先
- 支持多种方言
- 提供医疗专业领域模型
- 国内访问速度快

**缺点**:
- 主要针对中文
- 免费额度有限

## 技术方案推荐

### 第一阶段：原型验证（当前实现）

**选择**: Web Speech API

**理由**:
1. 快速验证语音交互的价值
2. 无需额外成本
3. 无需后端改动
4. 适合中文语音识别
5. 满足基本交互需求

**实现要点**:
- 使用 zh-CN 语言设置
- 实现固定命令模式（导航、答题、控制）
- 提供清晰的视觉反馈
- 处理浏览器兼容性问题

### 第二阶段：生产优化（未来扩展）

如果原型验证成功，可考虑以下优化：

**场景 A: 用户反馈识别准确率不足**
- 迁移到阿里云或讯飞语音服务
- 优势: 更高准确率，医疗领域优化
- 成本: 按使用量付费

**场景 B: 国际化需求**
- 迁移到 Google Cloud Speech
- 优势: 多语言支持
- 成本: 按使用量付费

**场景 C: 离线/低延迟需求**
- 保持 Web Speech API
- 考虑 WebAssembly 本地模型
- 优势: 隐私保护，低延迟

## 混合方案建议

最佳实践是实现一个抽象层，支持多种识别后端：

```typescript
interface VoiceRecognitionProvider {
  start(): void
  stop(): void
  onResult(callback: (text: string) => void): void
}

class WebSpeechProvider implements VoiceRecognitionProvider { }
class AzureSpeechProvider implements VoiceRecognitionProvider { }
class AliYunProvider implements VoiceRecognitionProvider { }
```

这样可以根据用户设置或环境自动切换。

## 性能对比

| 指标 | Web Speech API | 阿里云 | Google Cloud |
|------|----------------|--------|--------------|
| 延迟 | <100ms | 200-500ms | 300-600ms |
| 准确率（中文） | 85-90% | 95%+ | 93%+ |
| 成本 | 免费 | ¥0.0005/次 | $0.006/15s |
| 隐私 | 高 | 中 | 中 |
| 离线支持 | 部分浏览器 | 否 | 否 |

## 决策建议

**当前阶段**: 使用 Web Speech API
- 成本为零
- 满足原型需求
- 快速迭代

**评估指标**:
1. 用户使用率（启用语音功能用户占比）
2. 识别成功率（命令匹配率）
3. 用户反馈（满意度评分）
4. 浏览器兼容性统计

**切换条件**:
- 用户使用率 > 30%
- 识别满意度 < 3.5/5
- 用户明确反馈识别问题

## 参考资源

- [Web Speech API 规范](https://wicg.github.io/speech-api/)
- [Azure Speech 文档](https://docs.microsoft.com/azure/cognitive-services/speech-service/)
- [阿里云语音识别](https://www.aliyun.com/product/nls)
- [讯飞开放平台](https://www.xfyun.cn/)

## 可访问性评估

### WCAG 2.1 合规性

语音控制功能有助于满足以下 WCAG 成功标准：

#### 2.1.1 键盘 (Level A)
- **问题**: 用户无法使用传统键盘/鼠标
- **语音解决方案**: 用户可以通过语音命令完成所有操作
- **状态**: 部分满足 - 语音作为替代输入方式

#### 2.1.3 键盘（无例外）(Level A)
- **问题**: 某些功能无法通过键盘访问
- **语音解决方案**: 语音命令可以触发这些功能
- **状态**: 改善 - 提供额外的访问路径

#### 2.4.1 跳过链接 (Level A)
- **问题**: 导航困难，需要多次跳转
- **语音解决方案**: "跳转到首页"、"打开题库"等直接导航命令
- **状态**: 改善 - 快速直达目标页面

#### 2.5.1 目标尺寸 (Level A)
- **问题**: 小按钮难以点击（尤其是移动设备）
- **语音解决方案**: 语音命令无需精确点击
- **状态**: 改善 - 消除精度要求

### 目标用户群体

1. **运动障碍用户**
   - 关节炎、帕金森病等导致手部灵活性下降
   - 中风康复期用户
   - 临时手臂受伤用户

2. **视觉障碍用户**
   - 屏幕阅读器用户可结合语音命令导航
   - 减少复杂的手势操作需求

3. **多任务场景用户**
   - 医护人员在移动中查看资料
   - 学习者正在做笔记时浏览题目
   - 通勤途中使用应用

4. **老年用户**
   - 对复杂触控手势不熟悉
   - 语音交互更自然直观

### 已实现的辅助功能

1. **可禁用的语音反馈**
   - 用户可在设置中关闭语音播报
   - 避免在安静环境中造成干扰

2. **视觉反馈**
   - 语音控制按钮提供清晰的状态指示
   - 识别结果实时显示
   - 命令执行成功/失败提示

3. **按需启用**
   - 用户可完全关闭语音功能
   - 不干扰常规操作流程

4. **可调节的音量**
   - 语音反馈音量可调节
   - 适应不同听觉需求

### 潜在改进方向

1. **高对比度语音控制按钮** - 为视障用户提供更明显的视觉提示
2. **语音命令训练** - 帮助用户学习可用命令
3. **自定义命令** - 允许用户设置个性化语音快捷方式
4. **多语言支持** - 服务于非中文母语用户
5. **语音速度调节** - 适应不同认知处理速度

### 可访问性测试建议

1. **屏幕阅读器兼容性测试** - 确保语音控制与 NVDA/JAWS 协同工作
2. **键盘导航保留** - 语音不应替代键盘，而是作为补充
3. **色盲友好** - 语音控制指示器不应仅依赖颜色
4. **认知负荷评估** - 确保命令数量和复杂度适中
